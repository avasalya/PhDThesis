\chapter{Appendix: Handover}

\begin{lstlisting}[language=C++,basicstyle=\footnotesize, caption={wrench}]
const sva::ForceVecd 
ForceSensor::wrenchWithoutGravity(const mc_rbdyn::Robot & robot) const
{
sva::PTransformd X_0_p = 
robot.mbc().bodyPosW[robot.bodyIndexByName(parentBody_)];
auto w = wrench_ - calibration_->wfToSensor(X_0_p, X_p_f_);
return w;
}

sva::ForceVecd 
ForceSensor::worldWrench(const mc_rbdyn::Robot & robot) const
{
sva::ForceVecd w_fsactual = wrench();
sva::PTransformd X_parent_0 = 
robot.mbc().bodyPosW[robot.bodyIndexByName(parentBody_)].inv();
sva::PTransformd X_fsactual_0 = X_parent_0 * X_fsactual_parent();
return X_fsactual_0.dualMul(w_fsactual);
}

sva::ForceVecd 
ForceSensor::worldWrenchWithoutGravity(const mc_rbdyn::Robot & robot) const
{
sva::ForceVecd w_fsactual = wrenchWithoutGravity(robot);
sva::PTransformd X_parent_0 = 
robot.mbc().bodyPosW[robot.bodyIndexByName(parentBody_)].inv();
sva::PTransformd X_fsactual_0 = X_parent_0 * X_fsactual_parent();
return X_fsactual_0.dualMul(w_fsactual);
}
\end{lstlisting}